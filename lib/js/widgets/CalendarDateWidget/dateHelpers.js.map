{"version":3,"sources":["../../../../src/js/widgets/CalendarDateWidget/dateHelpers.js"],"names":["parseISODate","formatYear","formatDayMonth","formatISOPartialDate","setValidDate","dateString","split","year","month","day","val","numberVal","Number","dayOrMonth","toString","length","undefined","newState","value","validDate","Date","validMonth","getMonth","validDay","getDate","isDateInFuture"],"mappings":";;;;;;;;;;;;QAIgBA,Y,GAAAA,Y;QAgBAC,U,GAAAA,U;QAIAC,c,GAAAA,c;QAcAC,oB,GAAAA,oB;QAWAC,Y,GAAAA,Y;;AAhDhB;;;;AAEA;AACO,SAASJ,YAAT,CAAsBK,UAAtB,EAAkC;AACvC,MAAI,OAAOA,UAAP,KAAsB,QAA1B,EAAoC;AAAA,4BACPA,WAAWC,KAAX,CAAiB,GAAjB,EAAsB,CAAtB,CADO;AAAA;AAAA,QAC3BC,IAD2B;AAAA,QACrBC,KADqB;AAAA,QACdC,GADc;;AAElC,WAAO;AACLD,kBADK;AAELC,cAFK;AAGLF;AAHK,KAAP;AAKD;AACD,SAAO;AACLC,WAAO,EADF;AAELC,SAAK,EAFA;AAGLF,UAAM;AAHD,GAAP;AAKD;;AAEM,SAASN,UAAT,CAAoBS,GAApB,EAAyB;AAC9B,SAAOA,GAAP;AACD;;AAEM,SAASR,cAAT,CAAwBQ,GAAxB,EAA6B;AAClC,MAAIA,QAAQ,EAAZ,EAAgB,OAAO,EAAP;AAChB,MAAMC,YAAYC,OAAOF,GAAP,CAAlB;AACA,MAAIC,SAAJ,EAAe;AACb,QAAME,aAAaF,UAAUG,QAAV,EAAnB;AACA,QAAIF,OAAOC,UAAP,KAAsBA,WAAWE,MAAX,KAAsB,CAAhD,EAAmD;AACjD,mBAAWJ,SAAX;AACD,KAFD,MAEO,IAAIC,OAAOC,UAAP,CAAJ,EAAwB;AAC7B,aAAOA,UAAP;AACD;AACF;AACD,SAAO,EAAP;AACD;;AAEM,SAASV,oBAAT,OAAoD;AAAA,MAApBK,KAAoB,QAApBA,KAAoB;AAAA,MAAbC,GAAa,QAAbA,GAAa;AAAA,MAARF,IAAQ,QAARA,IAAQ;;AACzD,MAAIC,SAASC,GAAT,IAAgBF,IAApB,EAA0B;AACxB,WAAUN,WAAWM,IAAX,CAAV,SAA8BL,eAAeM,KAAf,CAA9B,SAAuDN,eAAeO,GAAf,CAAvD;AACD;;AAED,SAAOO,SAAP;AACD;;AAED;AACA;AACA;AACO,SAASZ,YAAT,CAAsBa,QAAtB,EAAgC;AAAA,wBACRA,SAASC,KADD;AAAA,MAC7BX,IAD6B,mBAC7BA,IAD6B;AAAA,MACvBC,KADuB,mBACvBA,KADuB;AAAA,MAChBC,GADgB,mBAChBA,GADgB;AAErC;;AACA,MAAMU,YAAY,IAAIC,IAAJ,CAASb,IAAT,EAAeC,QAAQ,CAAvB,EAA0BC,GAA1B,CAAlB;;AAEA,MAAMY,aAAaF,UAAUG,QAAV,KAAuB,CAA1C;AACA,MAAMC,WAAWJ,UAAUK,OAAV,EAAjB;;AAEA,MAAIH,eAAeT,OAAOJ,KAAP,CAAnB,EAAkC;AAChC,uBAAIS,QAAJ,EAAc,CAAC,OAAD,EAAU,OAAV,CAAd,EAAkCf,eAAemB,UAAf,CAAlC;AACD;AACD,MAAIE,aAAaX,OAAOH,GAAP,CAAjB,EAA8B;AAC5B,uBAAIQ,QAAJ,EAAc,CAAC,OAAD,EAAU,KAAV,CAAd,EAAgCf,eAAeqB,QAAf,CAAhC;AACD;;AAED;AACA,MAAME,iBAAiB,sBACrB,IAAIL,IAAJ,CAASb,IAAT,EAAeU,SAASC,KAAT,CAAeV,KAAf,GAAuB,CAAtC,EAAyCS,SAASC,KAAT,CAAeT,GAAxD,CADqB,EAErB,IAAIW,IAAJ,EAFqB,CAAvB;AAIA,MAAIK,cAAJ,EAAoB;AAClB;AACA;AACA,uBAAIR,QAAJ,EAAc,CAAC,OAAD,EAAU,MAAV,CAAd,EAAiCV,OAAO,CAAxC;AACD;;AAED,SAAOU,QAAP;AACD","file":"dateHelpers.js","sourcesContent":["import { set } from 'lodash';\nimport { isAfter } from 'date-fns';\n\n// dateString will be either a string in the form '2011-11-11' or undefined\nexport function parseISODate(dateString) {\n  if (typeof dateString === 'string') {\n    const [year, month, day] = dateString.split('-', 3);\n    return {\n      month,\n      day,\n      year\n    };\n  }\n  return {\n    month: '',\n    day: '',\n    year: '',\n  };\n}\n\nexport function formatYear(val) {\n  return val;\n}\n\nexport function formatDayMonth(val) {\n  if (val === '') return '';\n  const numberVal = Number(val);\n  if (numberVal) {\n    const dayOrMonth = numberVal.toString();\n    if (Number(dayOrMonth) && dayOrMonth.length === 1) {\n      return `0${numberVal}`;\n    } else if (Number(dayOrMonth)) {\n      return dayOrMonth;\n    }\n  }\n  return '';\n}\n\nexport function formatISOPartialDate({ month, day, year }) {\n  if (month && day && year) {\n    return `${formatYear(year)}-${formatDayMonth(month)}-${formatDayMonth(day)}`;\n  }\n\n  return undefined;\n}\n\n// Make sure that date is valid. If invalid, plug in approximate date.\n// Approximation is made by js Date parser's convention.\n// Ex: '02-31-2019' => '03-31-2019'\nexport function setValidDate(newState) {\n  const { year, month, day } = newState.value;\n  // A reminder that js Dates start months at index=0 ;)\n  const validDate = new Date(year, month - 1, day);\n\n  const validMonth = validDate.getMonth() + 1;\n  const validDay = validDate.getDate();\n\n  if (validMonth !== Number(month)) {\n    set(newState, ['value', 'month'], formatDayMonth(validMonth));\n  }\n  if (validDay !== Number(day)) {\n    set(newState, ['value', 'day'], formatDayMonth(validDay));\n  }\n\n  // If date is in the future, go back to last year\n  const isDateInFuture = isAfter(\n    new Date(year, newState.value.month - 1, newState.value.day),\n    new Date()\n  );\n  if (isDateInFuture) {\n    // Only need to subtract 1 year,\n    // Because we do not allow years that are greater than the current year\n    set(newState, ['value', 'year'], year - 1);\n  }\n\n  return newState;\n}\n"]}